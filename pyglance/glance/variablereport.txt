<%doc>
This Mako template is intended to create a variable specific report page for glance reportGen.

Created by Eva Schiffer Jun 2009.
Copyright (c) 2009 University of Wisconsin SSEC. All rights reserved.
</%doc>

<%!
    import types as types
    import glance.report as report
%>

## we will use this a lot, so hang on to it
<%
    variableName = runInfo['variable_name']
    variableDisplayName = variableName
    if (runInfo.has_key('display_name')):
        variableDisplayName = runInfo['display_name']
%>

<title>${variableDisplayName} Variable Comparison</title>
</head>
<body>
    
    <h1>${variableDisplayName} Variable Comparison</h1>
    
    <p>
        comparison produced ${runInfo['time']} by user ${runInfo['user']} on ${runInfo['machine']}
    </p>
    
    ## show information on each of the files we're comparing (should only be two)
    % for fileKey in sorted(list(files)) :
        <% tempFileInfo = files[fileKey] %>
        <p>
            ${fileKey}:
            % if tempFileInfo.has_key('displayName') :
                ${tempFileInfo['displayName']}
            % endif
            <blockquote>
                file path: ${tempFileInfo['path']} <br>
                md5sum for ${fileKey}: ${tempFileInfo['md5sum']} <br>
                last modified: ${tempFileInfo['lastModifiedTime']}
            </blockquote>
        </p>
    % endfor
    
    <p>
        latitude: ${runInfo['latitude']} <br>
        longitude: ${runInfo['longitude']}
    </p>
    
    <% shouldIncludeImages = runInfo['shouldIncludeImages'] %>
    % if shouldIncludeImages :
        <h3>Original Data</h3>
        <p>
            <a href="./${variableName}.A.png"><img src="./${variableName}.A.small.png"></a>
            <a href="./${variableName}.B.png"><img src="./${variableName}.B.small.png"></a>
        </p>
    % endif
    
    <h3>Comparison Information</h3>
    
    ## comparison parameters
    <p>
        variable name: ${variableName} <br>
        epsilon value: ${runInfo['epsilon']} <br>
        "missing" data value:
        <% missingDataValue = runInfo['missing_value'] %>
        % if missingDataValue is None :
            None
        % else :
            ${missingDataValue}
        % endif
    </p>
    
    <h3>Statistical Summary</h3>
    
    ## list out all of the statistics groups we have
    <dl>
    % for setName in sorted(list(statGroups)) :
        <% dataSet = statGroups[setName] %>
            <dt>
                ${setName}
            </dt>
            <dd>
                % for statName, statValue in sorted(list(dataSet.items())) :
                    ${statName}<a href="./doc.html">*</a>: ${report.make_formatted_display_string(statValue)} <br>
                % endfor
                <br>
            <dd>
    % endfor
    </dl>
    
    % if shouldIncludeImages :
    <p>
        <a href="./${variableName}.AbsDiff.png"><img src="./${variableName}.AbsDiff.small.png"></a>
        <a href="./${variableName}.Diff.png"><img src="./${variableName}.Diff.small.png"></a>
        <a href="./${variableName}.Trouble.png"><img src="./${variableName}.Trouble.small.png"></a>
        <a href="./${variableName}.Hist.png"><img src="./${variableName}.Hist.small.png"></a>
        <a href="./${variableName}.Scatter.png"><img src="./${variableName}.Scatter.small.png"></a>
    </p>
    % endif
    
</body>
</html>

